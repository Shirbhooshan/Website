<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Glasses Camera Dashboard</title>
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }
    .container {
        max-width: 700px;
        width: 100%;
        background: rgba(255,255,255,0.95);
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        backdrop-filter: blur(10px);
        text-align: center;
    }
    h1 {
        font-size: 32px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
    }
    .subtitle {
        color: #666;
        font-size: 14px;
        margin-bottom: 30px;
    }
    #cameraFeed {
        width: 100%;
        max-height: 400px;
        border-radius: 15px;
        background: #f0f0f0;
    }
    #cameraUpdate {
        margin-top: 10px;
        color: #999;
        font-size: 12px;
    }
    .toast {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #4CAF50;
        color: white;
        padding: 12px 18px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        animation: slideInRight 0.3s ease;
        z-index: 1000;
    }
    .toast.error { background: #f44336; }
    @keyframes slideInRight {
        from { opacity: 0; transform: translateX(100px); }
        to { opacity: 1; transform: translateX(0); }
    }
</style>
</head>
<body>
    <div class="container">
        <h1>ðŸ‘“ Smart Glasses Camera</h1>
        <p class="subtitle">Live feed from your ESP32 camera</p>
        <img id="cameraFeed" src="" alt="Camera feed will appear here">
        <div id="cameraUpdate">Waiting for camera...</div>
    </div>

    <script type="module">
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD9qxxWPMbt9hFUOfHsW6KXBOj88ig3psE",
            authDomain: "smart-glasses-ff6d1.firebaseapp.com",
            databaseURL: "https://smart-glasses-ff6d1-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "smart-glasses-ff6d1",
            storageBucket: "smart-glasses-ff6d1.firebasestorage.app",
            messagingSenderId: "461571246400",
            appId: "1:461571246400:web:fe3eeba3ad4883bb41d2a5",
            measurementId: "G-EVNL2R7FSX"
        };

        // Import Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, onValue } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        const cameraFeed = document.getElementById('cameraFeed');
        const cameraUpdate = document.getElementById('cameraUpdate');

        // Listen to camera feed
        const cameraRef = ref(database, 'camera/image');
        onValue(cameraRef, (snapshot) => {
            const data = snapshot.val();
            if (data && data.image) {
                cameraFeed.src = 'data:image/jpeg;base64,' + data.image;
                const timestamp = data.timestamp ? new Date(data.timestamp).toLocaleTimeString() : 'Just now';
                cameraUpdate.textContent = `Last updated: ${timestamp}`;
            }
        }, (error) => {
            console.error('Camera error:', error);
            cameraUpdate.textContent = 'Camera unavailable';
            showToast('Failed to load camera', 'error');
        });

        // Toast notifications
        function showToast(message, type='success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }
    </script>
</body>
</html>
